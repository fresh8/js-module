!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";var q="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var t,a=(function(t,e){t.exports=function(){function u(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,e=void 0,i=void 0,a=function(t,e){d[o]=t,d[o+1]=e,2===(o+=2)&&(i?i(l):m())},t="undefined"!=typeof window?window:void 0,r=t||{},s=r.MutationObserver||r.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(l,1)}}var d=new Array(1e3);function l(){for(var t=0;t<o;t+=2){var e=d[t],n=d[t+1];e(n),d[t]=void 0,d[t+1]=void 0}o=0}var p,v,y,w,m=void 0;function b(t,e){var n=this,o=new this.constructor(A);void 0===o[_]&&L(o);var i=n._state;if(i){var r=arguments[i-1];a(function(){return x(i,o,r,n._result)})}else R(n,o,t,e);return o}function g(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return F(e,t),e}m=c?function(){return process.nextTick(l)}:s?(v=0,y=new s(l),w=document.createTextNode(""),y.observe(w,{characterData:!0}),function(){w.data=v=++v%2}):h?((p=new MessageChannel).port1.onmessage=l,function(){return p.port2.postMessage(0)}):void 0===t?function(){try{var t=Function("return this")().require("vertx");return void 0===(e=t.runOnLoop||t.runOnContext)?f():function(){e(l)}}catch(t){return f()}}():f();var _=Math.random().toString(36).substring(2);function A(){}var S=void 0,E=1,P=2,C={error:null};function k(t){try{return t.then}catch(t){return C.error=t,C}}function I(t,e,n,o){try{t.call(e,n,o)}catch(t){return t}}function O(t,e,n){var o,i,r,s;e.constructor===t.constructor&&n===b&&e.constructor.resolve===g?(r=t,(s=e)._state===E?j(r,s._result):s._state===P?D(r,s._result):R(s,void 0,function(t){return F(r,t)},function(t){return D(r,t)})):n===C?(D(t,C.error),C.error=null):void 0===n?j(t,e):u(n)?(o=e,i=n,a(function(e){var n=!1,t=I(i,o,function(t){n||(n=!0,o!==t?F(e,t):j(e,t))},function(t){n||(n=!0,D(e,t))},e._label);!n&&t&&(n=!0,D(e,t))},t)):j(t,e)}function F(t,e){var n,o;t===e?D(t,new TypeError("You cannot resolve a promise with itself")):(o=typeof(n=e),null===n||"object"!==o&&"function"!==o?j(t,e):O(t,e,k(e)))}function T(t){t._onerror&&t._onerror(t._result),B(t)}function j(t,e){t._state===S&&(t._result=e,t._state=E,0!==t._subscribers.length&&a(B,t))}function D(t,e){t._state===S&&(t._state=P,t._result=e,a(T,t))}function R(t,e,n,o){var i=t._subscribers,r=i.length;t._onerror=null,i[r]=e,i[r+E]=n,i[r+P]=o,0===r&&t._state&&a(B,t)}function B(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var o=void 0,i=void 0,r=t._result,s=0;s<e.length;s+=3)o=e[s],i=e[s+n],o?x(n,o,i,r):i(r);t._subscribers.length=0}}function x(t,e,n,o){var i=u(n),r=void 0,s=void 0,a=void 0,c=void 0;if(i){if((r=function(t,e){try{return t(e)}catch(t){return C.error=t,C}}(n,o))===C?(c=!0,s=r.error,r.error=null):a=!0,e===r)return void D(e,new TypeError("A promises callback cannot return that same promise."))}else r=o,a=!0;e._state!==S||(i&&a?F(e,r):c?D(e,s):t===E?j(e,r):t===P&&D(e,r))}var U=0;function L(t){t[_]=U++,t._state=void 0,t._result=void 0,t._subscribers=[]}var M=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(A),this.promise[_]||L(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&j(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===S&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,o=n.resolve;if(o===g){var i=k(e);if(i===b&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===H){var r=new n(A);O(r,e,i),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},t.prototype._settledAt=function(t,e,n){var o=this.promise;o._state===S&&(this._remaining--,t===P?D(o,n):this._result[e]=n),0===this._remaining&&j(o,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;R(t,void 0,function(t){return n._settledAt(E,e,t)},function(t){return n._settledAt(P,e,t)})},t}(),H=function(){function e(t){this[_]=U++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){F(e,t)},function(t){D(e,t)})}catch(t){D(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return u(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return H.prototype.then=b,H.all=function(t){return new M(this,t).promise},H.race=function(i){var r=this;return n(i)?new r(function(t,e){for(var n=i.length,o=0;o<n;o++)r.resolve(i[o]).then(t,e)}):new r(function(t,e){return e(new TypeError("You must pass an array to race."))})},H.resolve=g,H.reject=function(t){var e=new this(A);return D(e,t),e},H._setScheduler=function(t){i=t},H._setAsap=function(t){a=t},H._asap=a,H.polyfill=function(){var t=void 0;if(void 0!==q)t=q;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=H},H.Promise=H}()}(t={exports:{}},t.exports),t.exports),n="URLSearchParams"in self,o="Symbol"in self&&"iterator"in Symbol,c="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in self,r="ArrayBuffer"in self;if(r)var e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))};function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(t){if(t.bodyUsed)return a.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(n){return new a(function(t,e){n.onload=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function v(t){var e=new FileReader,n=p(e);return e.readAsArrayBuffer(t),n}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(t){var e;(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:c&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():r&&c&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c&&(this.blob=function(){var t=l(this);if(t)return t;if(this._bodyBlob)return a.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return a.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return a.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||a.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var t,e,n,o=l(this);if(o)return o;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=p(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return a.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),o=0;o<e.length;o++)n[o]=String.fromCharCode(e[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return a.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(t,e){t=u(t),e=h(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},d.prototype.delete=function(t){delete this.map[u(t)]},d.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},d.prototype.set=function(t,e){this.map[u(t)]=h(e)},d.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},d.prototype.keys=function(){var n=[];return this.forEach(function(t,e){n.push(e)}),f(n)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),f(e)},d.prototype.entries=function(){var n=[];return this.forEach(function(t,e){n.push([e,t])}),f(n)},o&&(d.prototype[Symbol.iterator]=d.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t,e){var n,o,i=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(n=e.method||this.method||"GET",o=n.toUpperCase(),-1<m.indexOf(o)?o:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(t){var i=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),n=e.shift().replace(/\+/g," "),o=e.join("=").replace(/\+/g," ");i.append(decodeURIComponent(n),decodeURIComponent(o))}}),i}function _(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},w.call(b.prototype),w.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},_.error=function(){var t=new _(null,{status:0,statusText:""});return t.type="error",t};var A=[301,302,303,307,308];_.redirect=function(t,e){if(-1===A.indexOf(e))throw new RangeError("Invalid status code");return new _(null,{status:e,headers:{location:t}})};var S=self.DOMException;try{new S}catch(t){(S=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function E(i,s){return new a(function(o,t){var e=new b(i,s);if(e.signal&&e.signal.aborted)return t(new S("Aborted","AbortError"));var r=new XMLHttpRequest;function n(){r.abort()}r.onload=function(){var t,i,e={status:r.status,statusText:r.statusText,headers:(t=r.getAllResponseHeaders()||"",i=new d,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var e=t.split(":"),n=e.shift().trim();if(n){var o=e.join(":").trim();i.append(n,o)}}),i)};e.url="responseURL"in r?r.responseURL:e.headers.get("X-Request-URL");var n="response"in r?r.response:r.responseText;o(new _(n,e))},r.onerror=function(){t(new TypeError("Network request failed"))},r.ontimeout=function(){t(new TypeError("Network request failed"))},r.onabort=function(){t(new S("Aborted","AbortError"))},r.open(e.method,e.url,!0),"include"===e.credentials?r.withCredentials=!0:"omit"===e.credentials&&(r.withCredentials=!1),"responseType"in r&&c&&(r.responseType="blob"),e.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),e.signal&&(e.signal.addEventListener("abort",n),r.onreadystatechange=function(){4===r.readyState&&e.signal.removeEventListener("abort",n)}),r.send(void 0===e._bodyInit?null:e._bodyInit)})}function P(t){var e=new Error(t);return e.name="invaildeConfig",e}function C(t){var e=document.createElement("script");e.type="text/javascript",e.src=t,e.async="async",document.body.appendChild(e)}E.polyfill=!0,self.fetch||(self.fetch=E,self.Headers=d,self.Request=b,self.Response=_);var k=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},I=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}(),O=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function F(t){var e=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(void 0===t.endpoint||""===t.endpoint)throw P('Missing "endpoint"');if(void 0===t.slotID||""===t.slotID)throw P('Missing "slotID"');if(void 0===t.window||""===t.window)throw P('Missing "window"');void 0===t.inApp&&(t.inApp=!1);void 0===t.shouldBreakOut&&(t.shouldBreakOut=!1);void 0===t.linkSameWindow&&(t.linkSameWindow=!1);void 0===t.competitorIDs&&(t.competitorIDs=[]);void 0===t.competitors&&(t.competitors=[]);void 0===t.competitionIDs&&(t.competitionIDs=[]);void 0===t.competitions&&(t.competitions=[]);void 0===t.listenOnPushState&&(t.listenOnPushState=!1);if(0===t.competitors.length&&0===t.competitions.length||t.sport)return t;throw P('Sport is required if "competitions" or "competitors" is passed through in the config')}(t),n=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=O({},e);void 0!==n.competitorIds&&(n.competitorIds=n.competitorIds.map(function(t){return encodeURIComponent(t)}));void 0!==n.competitors&&(n.competitors=n.competitors.map(function(t){return encodeURIComponent(t)}));void 0!==n.competitionIds&&(n.competitionIds=n.competitionIds.map(function(t){return encodeURIComponent(t)}));void 0!==n.competitions&&(n.competitions=n.competitions.map(function(t){return encodeURIComponent(t)}));var o=(i=n,r="?",Object.keys(i).forEach(function(t){var e=i[t];e&&""!==e&&0!==e.length&&("[object Array]"===Object.prototype.toString.call(e)?r+=t+"="+e.join(",")+"&":r+=t+"="+e+"&")}),r);var i,r;return t+o}(e.endpoint,{slot:e.slotID,view:e.view,clickUrl:e.clickTrackingRedirect,sport:e.sport,match:e.match,competitorIds:e.competitorIDs,competitors:e.competitors,competitionIds:e.competitionIDs,competitions:e.competitions,linkSameWindow:e.linkSameWindow,brand:e.brand,ref:function(t,e,n){if(n&&void 0!==n&&""!==n)return encodeURIComponent(n);for(var o=t.document.getElementsByTagName("link"),i=t.location.href,r=null,s=0;s<o.length;s++)if("canonical"===o[s].rel){r=o[s].href;break}return e?"about:blank":encodeURIComponent(r||i)}(e.window,e.inApp,e.url)});return fetch(n,{credentials:"include"}).then(T).then(j)}function T(t){return 200<=t.status&&t.status<300?t:a.reject("Server returned error: "+t.status)}function j(t){if(t)return t.json()}var D=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};k(this,e),this.active=!1,this.awaitingFactory=!0,this.selector=null,this.creativeRef=null,this.creativePath=null,this.CSSPath=null,this.data=null,this.env=null,this.loadResolvers=null,this.adInstance=null,this.config=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(void 0===t.endpoint||""===t.endpoint)throw P('Missing "endpoint"');if(void 0===t.creativeFactoryCache||""===t.creativeFactoryCache)throw P('Missing "creativeFactoryCache"');if(void 0===t.slotID||""===t.slotID)throw P('Missing "slotID"');if(void 0===t.appendPoint||""===t.appendPoint)throw P('Missing "appendPoint"');if(void 0===t.window||""===t.window)throw P('Missing "window"');void 0===t.inApp&&(t.inApp=!1);void 0===t.shouldBreakOut&&(t.shouldBreakOut=!1);void 0===t.linkSameWindow&&(t.linkSameWindow=!1);void 0===t.competitorIDs&&(t.competitorIDs=[]);void 0===t.competitors&&(t.competitors=[]);void 0===t.competitionIDs&&(t.competitionIDs=[]);void 0===t.competitions&&(t.competitions=[]);void 0===t.listenOnPushState&&(t.listenOnPushState=!1);if(0===t.competitors.length&&0===t.competitions.length||t.sport)return t;throw P('Sport is required if "competitions" or "competitors" is passed through in the config')}(t),this.creativeFactoryCache=t.creativeFactoryCache,this.window=t.window,this.evo=!1}return I(e,[{key:"load",value:function(){var i=this;return new a(function(n,o){return F({slotID:i.config.slotID,view:i.config.view,clickTrackingRedirect:i.config.clickTrackingRedirect,sport:i.config.sport,match:i.config.match,competitorIDs:i.config.competitorIDs,competitors:i.config.competitors,competitionIDs:i.config.competitionIDs,competitions:i.config.competitions,window:i.config.window,inApp:i.config.inApp,endpoint:i.config.endpoint,appendPoint:i.config.appendPoint,linkSameWindow:i.config.linkSameWindow,url:i.config.url,brand:i.config.brand}).then(function(e){var t={resolve:n,reject:o};if(i.loadResolvers=t,e.env&&(i.evo=!0),i.evo?Object.keys(e.products).forEach(function(t){i.creativeRef=e.products[t].config,i.CSSPath=e.products[t].skin,i.data=e.products[t].instances[0],i.env=e.env,i.creativePath=e.env.cdn+"/"+e.products[t].config+".js?v="+e.env.version,i.data.appendPoint=i.config.appendPoint}):Object.keys(e).forEach(function(t){i.creativeRef=t,i.CSSPath=e[t].CSSPath,i.data=e[t].instances[0].data,i.env=e[t].instances[0].env,i.creativePath=e[t].creativePath,i.data.appendPoint=i.config.appendPoint}),i.env.adhesion?i.selector="#f8-adhesion":i.selector=i.config.appendPoint+" .f8"+i.creativeRef,!i.awaitingFactory)return i._callCreativeFactory();C(i.creativePath)}).catch(function(t){i.active=!1,o(t)})})}},{key:"reload",value:function(){var r=this;return new a(function(o,i){return F({slotID:r.config.slotID,view:r.config.view,clickTrackingRedirect:r.config.clickTrackingRedirect,sport:r.config.sport,match:r.config.match,competitorIDs:r.config.competitorIDs,competitors:r.config.competitors,competitionIDs:r.config.competitionIDs,competitions:r.config.competitions,window:r.config.window,inApp:r.config.inApp,endpoint:r.config.endpoint,appendPoint:r.config.appendPoint,linkSameWindow:r.config.linkSameWindow,url:r.config.url,brand:r.config.brand}).then(function(e){var t=void 0;t=r.evo?e.products[0].config:Object.keys(e)[0];var n={resolve:o,reject:i};return r.loadResolvers=n,r.destroy(),t!==r.creativeRef&&(r.creativeRef=t,r.evo?r.creativePath=e.env.cdn+"/"+e.products[0].config+".js?v="+e.env.version:r.creativePath=e[t].creativePath,r._switchAdType()),r.evo?Object.keys(e.products).forEach(function(t){r.CSSPath=e.products[t].skin,r.data=e.products[t].instances[0],r.env=e.env,r.data.appendPoint=r.config.appendPoint}):Object.keys(e).forEach(function(t){r.CSSPath=e[t].CSSPath,r.data=e[t].instances[0].data,r.env=e[t].instances[0].env,r.data.appendPoint=r.config.appendPoint}),r.selector=r.config.appendPoint+" .f8"+r.creativeRef,r._callCreativeFactory()}).catch(i)})}},{key:"destroy",value:function(){if(this.active){var t=document.querySelector(this.selector);this.adInstance.destroy(),this.evo||t.parentNode.removeChild(t),this.active=!1}}},{key:"_switchAdType",value:function(){this.creativeFactoryCache.exists(this.creativeRef)?this._setCreativeFactory(this.creativeFactoryCache.get(this.creativeRef)):(this.awaitingFactory=!0,C(this.creativePath))}},{key:"_setCreativeFactory",value:function(t){this.awaitingFactory=!1,this.creativeFactory=t}},{key:"_callCreativeFactory",value:function(){var e=this;return this.awaitingFactory?a.resolve():this.creativeFactory(this.env,this.data,this.CSSPath,this.window).then(function(t){e.adInstance=t,e.active=!0,e.loadResolvers.resolve(e)}).catch(this.loadResolvers.reject)}}]),e}();var R=function(){function t(){k(this,t),this.cache={}}return I(t,[{key:"put",value:function(t,e){this.cache[t]=e}},{key:"remove",value:function(t){this.cache[t]&&delete this.cache[t]}},{key:"get",value:function(t){return this.cache[t]}},{key:"exists",value:function(t){return!!this.cache[t]}}]),t}();function B(){var e=window.history.pushState,n=new CustomEvent("__f8-history-push-state");function t(){var t=e.apply(this,arguments);return window.dispatchEvent(n),t}return{restore:function(){window.history.pushState=e},fill:function(){history.pushState=t}}}var x=function(){function e(t){var n,o;k(this,e),this.Ad=D,function(){if("function"==typeof window.CustomEvent)return;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}(),this.config=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(void 0===t.instID||""===t.instID)throw P('Missing "instID" in config');return void 0!==t.endpoint&&""!==t.endpoint||(t.endpoint="https://fresh8.co/"+t.instID+"/raw"),void 0===t.inApp&&(t.inApp=!1),void 0===t.shouldBreakOut&&(t.shouldBreakOut=!1),void 0===t.listenOnPushState&&(t.listenOnPushState=!1),t}(t),this.window=function(t){var e=window;if(t)try{for(;e!==e.top;)e.parent.location.href,e=e.parent}catch(t){}return e}(this.config.shouldBreakOut),this.ads=[],this.creativeFactoryCache=new R,n="1.0.0",(o=this.window).__f8||(o.__f8={}),o.__f8[n]||(o.__f8[n]={}),o.__f8[n].setUndefinedProperty=function(t,e){if(o.__f8[n][t])return o.__f8[n][t];if(e)return"function"==typeof e?(o.__f8[n][t]=e(),o.__f8[n][t]):o.__f8[n][t]=e;throw new Error("Trying to access f8 v"+n+" property "+t+", but its not defined")},this._addEventLisnters(),this.config.listenOnPushState&&(this.polyfillHistoryPushState=new B,this.polyfillHistoryPushState.fill())}return I(e,[{key:"requestAd",value:function(){var n=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new a(function(t){o.endpoint=n.config.endpoint,o.window=n.window,o.creativeFactoryCache=n.creativeFactoryCache;var e=new n.Ad(o);return n.ads.push(e),t(e.load())})}},{key:"remove",value:function(){this._removeEventLisnters(),this.destroyAllAds(),this.config.listenOnPushState&&this.polyfillHistoryPushState.restore()}},{key:"reloadAllAds",value:function(){var t=this.ads.filter(function(t){return t.active});return a.all(t.map(function(t){return t.reload()}))}},{key:"destroyAllAds",value:function(){var t=this.ads.filter(function(t){return t.active});return a.all(t.map(function(t){return t.destroy()}))}},{key:"_addEventLisnters",value:function(){this.boundOnCreativeLoaded=this._onCreativeLoaded.bind(this),this.boundOnHistoryPushStateChange=this._onHistoryPushStateChange.bind(this),this.window.addEventListener("__f8-creative-script-loaded",this.boundOnCreativeLoaded),this.window.addEventListener("__f8-product-script-loaded",this.boundOnCreativeLoaded),this.window.addEventListener("__f8-history-push-state",this.boundOnHistoryPushStateChange)}},{key:"_removeEventLisnters",value:function(){this.window.removeEventListener("__f8-creative-script-loaded",this.boundOnCreativeLoaded),this.window.removeEventListener("__f8-product-script-loaded",this.boundOnCreativeLoaded),this.window.removeEventListener("__f8-history-push-state",this.boundOnHistoryPushStateChange)}},{key:"_onCreativeLoaded",value:function(e){this.creativeFactoryCache.put(e.creativeRef,e.creativeFactory),this.ads.forEach(function(t){t.evo?t.awaitingFactory&&e.config===t.creativeRef&&(t._setCreativeFactory(e.productFactory),t._callCreativeFactory()):t.awaitingFactory&&e.creativeRef===t.creativeRef&&(t._setCreativeFactory(e.creativeFactory),t._callCreativeFactory())})}},{key:"_onHistoryPushStateChange",value:function(){this.reloadAllAds().catch()}}]),e}();window.Fresh8||(window.Fresh8=x)});
//# sourceMappingURL=browser.js.map
