!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function n(t){var e=new Error(t);return e.name="invaildeConfig",e}function r(t){var e=document.createElement("script");e.type="text/javascript",e.src=t,e.async="async",document.body.appendChild(e)}function t(t){var e=function(t){void 0===t&&(t={});if(void 0===t.endpoint||""===t.endpoint)throw n('Missing "endpoint"');if(void 0===t.slotID||""===t.slotID)throw n('Missing "slotID"');if(void 0===t.window||""===t.window)throw n('Missing "window"');void 0===t.inApp&&(t.inApp=!1);void 0===t.shouldBreakOut&&(t.shouldBreakOut=!1);void 0===t.linkSameWindow&&(t.linkSameWindow=!1);void 0===t.competitorIDs&&(t.competitorIDs=[]);void 0===t.competitors&&(t.competitors=[]);void 0===t.competitionIDs&&(t.competitionIDs=[]);void 0===t.competitions&&(t.competitions=[]);void 0===t.listenOnPushState&&(t.listenOnPushState=!1);if(0===t.competitors.length&&0===t.competitions.length||t.sport)return t;throw n('Sport is required if "competitions" or "competitors" is passed through in the config')}(t),o=function(t,e){void 0===e&&(e={});var o=Object.assign({},e);void 0!==o.competitorIds&&(o.competitorIds=o.competitorIds.map(function(t){return encodeURIComponent(t)}));void 0!==o.competitors&&(o.competitors=o.competitors.map(function(t){return encodeURIComponent(t)}));void 0!==o.competitionIds&&(o.competitionIds=o.competitionIds.map(function(t){return encodeURIComponent(t)}));void 0!==o.competitions&&(o.competitions=o.competitions.map(function(t){return encodeURIComponent(t)}));var i=(n=o,r="?",Object.keys(n).forEach(function(t){var e=n[t];e&&""!==e&&0!==e.length&&("[object Array]"===Object.prototype.toString.call(e)?r+=t+"="+e.join(",")+"&":r+=t+"="+e+"&")}),r);var n,r;return t+i}(e.endpoint,{slot:e.slotID,view:e.view,clickUrl:e.clickTrackingRedirect,sport:e.sport,match:e.match,competitorIds:e.competitorIDs,competitors:e.competitors,competitionIds:e.competitionIDs,competitions:e.competitions,linkSameWindow:e.linkSameWindow,brand:e.brand,ref:function(t,e,o){if(o&&void 0!==o&&""!==o)return encodeURIComponent(o);for(var i=t.document.getElementsByTagName("link"),n=t.location.href,r=null,s=0;s<i.length;s++)if("canonical"===i[s].rel){r=i[s].href;break}return e?"about:blank":encodeURIComponent(r||n)}(e.window,e.inApp,e.url)});return fetch(o,{credentials:"include"}).then(i).then(s)}function i(t){return 200<=t.status&&t.status<300?t:Promise.reject("Server returned error: "+t.status)}function s(t){if(t)return t.json()}!function(t){if(!t.fetch){var e="URLSearchParams"in t,o="Symbol"in t&&"iterator"in Symbol,s="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,n="ArrayBuffer"in t;if(n)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(t){return t&&DataView.prototype.isPrototypeOf(t)},c=ArrayBuffer.isView||function(t){return t&&-1<r.indexOf(Object.prototype.toString.call(t))};l.prototype.append=function(t,e){t=p(t),e=u(e);var o=this.map[t];o||(o=[],this.map[t]=o),o.push(e)},l.prototype.delete=function(t){delete this.map[p(t)]},l.prototype.get=function(t){var e=this.map[p(t)];return e?e[0]:null},l.prototype.getAll=function(t){return this.map[p(t)]||[]},l.prototype.has=function(t){return this.map.hasOwnProperty(p(t))},l.prototype.set=function(t,e){this.map[p(t)]=[u(e)]},l.prototype.forEach=function(o,i){Object.getOwnPropertyNames(this.map).forEach(function(e){this.map[e].forEach(function(t){o.call(i,t,e,this)},this)},this)},l.prototype.keys=function(){var o=[];return this.forEach(function(t,e){o.push(e)}),f(o)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),f(e)},l.prototype.entries=function(){var o=[];return this.forEach(function(t,e){o.push([e,t])}),f(o)},o&&(l.prototype[Symbol.iterator]=l.prototype.entries);var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},b.call(g.prototype),b.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},P.error=function(){var t=new P(null,{status:0,statusText:""});return t.type="error",t};var h=[301,302,303,307,308];P.redirect=function(t,e){if(-1===h.indexOf(e))throw new RangeError("Invalid status code");return new P(null,{status:e,headers:{location:t}})},t.Headers=l,t.Request=g,t.Response=P,t.fetch=function(o,n){return new Promise(function(i,t){var e=new g(o,n),r=new XMLHttpRequest;r.onload=function(){var t,n,e={status:r.status,statusText:r.statusText,headers:(t=r.getAllResponseHeaders()||"",n=new l,t.split("\r\n").forEach(function(t){var e=t.split(":"),o=e.shift().trim();if(o){var i=e.join(":").trim();n.append(o,i)}}),n)};e.url="responseURL"in r?r.responseURL:e.headers.get("X-Request-URL");var o="response"in r?r.response:r.responseText;i(new P(o,e))},r.onerror=function(){t(new TypeError("Network request failed"))},r.ontimeout=function(){t(new TypeError("Network request failed"))},r.open(e.method,e.url,!0),"include"===e.credentials&&(r.withCredentials=!0),"responseType"in r&&s&&(r.responseType="blob"),e.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.send(void 0===e._bodyInit?null:e._bodyInit)})},t.fetch.polyfill=!0}function p(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function l(e){this.map={},e instanceof l?e.forEach(function(t,e){this.append(e,t)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function y(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function v(o){return new Promise(function(t,e){o.onload=function(){t(o.result)},o.onerror=function(){e(o.error)}})}function m(t){var e=new FileReader,o=v(e);return e.readAsArrayBuffer(t),o}function w(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t)if("string"==typeof t)this._bodyText=t;else if(s&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(i&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(n&&s&&a(t))this._bodyArrayBuffer=w(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!n||!ArrayBuffer.prototype.isPrototypeOf(t)&&!c(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=w(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var t=y(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var t,e,o,i=y(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,o=v(e),e.readAsText(t),o;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),o=new Array(e.length),i=0;i<e.length;i++)o[i]=String.fromCharCode(e[i]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(t,e){var o,i,n=(e=e||{}).body;if("string"==typeof t)this.url=t;else{if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=(o=e.method||this.method||"GET",i=o.toUpperCase(),-1<d.indexOf(i)?i:o),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function _(t){var n=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),o=e.shift().replace(/\+/g," "),i=e.join("=").replace(/\+/g," ");n.append(decodeURIComponent(o),decodeURIComponent(i))}}),n}function P(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:window);var e=function(t){void 0===t&&(t={}),this.active=!1,this.awaitingFactory=!0,this.selector=null,this.creativeRef=null,this.creativePath=null,this.CSSPath=null,this.data=null,this.env=null,this.loadResolvers=null,this.adInstance=null,this.config=function(t){void 0===t&&(t={});if(void 0===t.endpoint||""===t.endpoint)throw n('Missing "endpoint"');if(void 0===t.creativeFactoryCache||""===t.creativeFactoryCache)throw n('Missing "creativeFactoryCache"');if(void 0===t.slotID||""===t.slotID)throw n('Missing "slotID"');if(void 0===t.appendPoint||""===t.appendPoint)throw n('Missing "appendPoint"');if(void 0===t.window||""===t.window)throw n('Missing "window"');void 0===t.inApp&&(t.inApp=!1);void 0===t.shouldBreakOut&&(t.shouldBreakOut=!1);void 0===t.linkSameWindow&&(t.linkSameWindow=!1);void 0===t.competitorIDs&&(t.competitorIDs=[]);void 0===t.competitors&&(t.competitors=[]);void 0===t.competitionIDs&&(t.competitionIDs=[]);void 0===t.competitions&&(t.competitions=[]);void 0===t.listenOnPushState&&(t.listenOnPushState=!1);if(0===t.competitors.length&&0===t.competitions.length||t.sport)return t;throw n('Sport is required if "competitions" or "competitors" is passed through in the config')}(t),this.creativeFactoryCache=t.creativeFactoryCache,this.window=t.window,this.evo=!1};e.prototype.load=function(){var n=this;return new Promise(function(o,i){t({slotID:n.config.slotID,view:n.config.view,clickTrackingRedirect:n.config.clickTrackingRedirect,sport:n.config.sport,match:n.config.match,competitorIDs:n.config.competitorIDs,competitors:n.config.competitors,competitionIDs:n.config.competitionIDs,competitions:n.config.competitions,window:n.config.window,inApp:n.config.inApp,endpoint:n.config.endpoint,appendPoint:n.config.appendPoint,linkSameWindow:n.config.linkSameWindow,url:n.config.url,brand:n.config.brand}).then(function(e){var t={resolve:o,reject:i};n.loadResolvers=t,e.env?e.env&&(n.evo=!0,Object.keys(e.products).forEach(function(t){n.creativeRef=e.products[t].config,n.CSSPath=e.products[t].skin,n.data=e.products[t].instances[0],n.env=e.env,n.creativePath=e.env.cdn+"/"+e.products[t].config+".js?v="+e.env.version,n.data.appendPoint=n.config.appendPoint})):Object.keys(e).forEach(function(t){n.creativeRef=t,n.CSSPath=e[t].CSSPath,n.data=e[t].instances[0].data,n.env=e[t].instances[0].env,n.creativePath=e[t].creativePath,n.data.appendPoint=n.config.appendPoint}),n.env.adhesion?n.selector="#f8-adhesion":n.selector=n.config.appendPoint+" .f8"+n.creativeRef,n.awaitingFactory?r(n.creativePath):n._callCreativeFactory()}).catch(function(t){n.active=!1,i(t)})})},e.prototype.reload=function(){var r=this;return new Promise(function(i,n){t({slotID:r.config.slotID,view:r.config.view,clickTrackingRedirect:r.config.clickTrackingRedirect,sport:r.config.sport,match:r.config.match,competitorIDs:r.config.competitorIDs,competitors:r.config.competitors,competitionIDs:r.config.competitionIDs,competitions:r.config.competitions,window:r.config.window,inApp:r.config.inApp,endpoint:r.config.endpoint,appendPoint:r.config.appendPoint,linkSameWindow:r.config.linkSameWindow,url:r.config.url,brand:r.config.brand}).then(function(t){var e=Object.keys(t)[0],o={resolve:i,reject:n};return r.loadResolvers=o,r.destroy(),e!==r.creativeRef&&(r.creativeRef=e,r.creativePath=t[e].creativePath,r._switchAdType()),r.data=t[r.creativeRef].instances[0].data,r.env=t[r.creativeRef].instances[0].env,r.CSSPath=t[r.creativeRef].CSSPath,r.data.appendPoint=r.config.appendPoint,r.selector=r.config.appendPoint+" .f8"+r.creativeRef,r._callCreativeFactory()}).catch(n)})},e.prototype.destroy=function(){if(this.active){var t=document.querySelector(this.selector);this.adInstance.destroy(),t.parentNode.removeChild(t),this.active=!1}},e.prototype._switchAdType=function(){this.creativeFactoryCache.exists(this.creativeRef)?this._setCreativeFactory(this.creativeFactoryCache.get(this.creativeRef)):(this.awaitingFactory=!0,r(this.creativePath))},e.prototype._setCreativeFactory=function(t){this.awaitingFactory=!1,this.creativeFactory=t},e.prototype._callCreativeFactory=function(){var e=this;return this.awaitingFactory?Promise.resolve():this.creativeFactory(this.env,this.data,this.CSSPath,this.window).then(function(t){e.adInstance=t,e.active=!0,e.loadResolvers.resolve(e)}).catch(this.loadResolvers.reject)};var a=function(){this.cache={}};function c(){var e=window.history.pushState,o=new CustomEvent("__f8-history-push-state");function t(){var t=e.apply(this,arguments);return window.dispatchEvent(o),t}return{restore:function(){window.history.pushState=e},fill:function(){history.pushState=t}}}a.prototype.put=function(t,e){this.cache[t]=e},a.prototype.remove=function(t){this.cache[t]&&delete this.cache[t]},a.prototype.get=function(t){return this.cache[t]},a.prototype.exists=function(t){return!!this.cache[t]};var o=function(t){var o,i;this.Ad=e,function(){if("function"==typeof window.CustomEvent)return;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),o}t.prototype=window.Event.prototype,window.CustomEvent=t}(),this.config=function(t){if(void 0===t&&(t={}),void 0===t.instID||""===t.instID)throw n('Missing "instID" in config');return void 0!==t.endpoint&&""!==t.endpoint||(t.endpoint="https://fresh8.co/"+t.instID+"/raw"),void 0===t.inApp&&(t.inApp=!1),void 0===t.shouldBreakOut&&(t.shouldBreakOut=!1),void 0===t.listenOnPushState&&(t.listenOnPushState=!1),t}(t),this.window=function(t){var e=window;if(t)try{for(;e!==e.top;)e.parent.location.href,e=e.parent}catch(t){}return e}(this.config.shouldBreakOut),this.ads=[],this.creativeFactoryCache=new a,o="1.0.0",(i=this.window).__f8||(i.__f8={}),i.__f8[o]||(i.__f8[o]={}),i.__f8[o].setUndefinedProperty=function(t,e){if(i.__f8[o][t])return i.__f8[o][t];if(e)return"function"==typeof e?(i.__f8[o][t]=e(),i.__f8[o][t]):i.__f8[o][t]=e;throw new Error("Trying to access f8 v"+o+" property "+t+", but its not defined")},this._addEventLisnters(),this.config.listenOnPushState&&(this.polyfillHistoryPushState=new c,this.polyfillHistoryPushState.fill())};o.prototype.requestAd=function(o){var i=this;return void 0===o&&(o={}),new Promise(function(t){o.endpoint=i.config.endpoint,o.window=i.window,o.creativeFactoryCache=i.creativeFactoryCache;var e=new i.Ad(o);return i.ads.push(e),t(e.load())})},o.prototype.remove=function(){this._removeEventLisnters(),this.destroyAllAds(),this.config.listenOnPushState&&this.polyfillHistoryPushState.restore()},o.prototype.reloadAllAds=function(){var t=this.ads.filter(function(t){return t.active});return Promise.all(t.map(function(t){return t.reload()}))},o.prototype.destroyAllAds=function(){var t=this.ads.filter(function(t){return t.active});return Promise.all(t.map(function(t){return t.destroy()}))},o.prototype._addEventLisnters=function(){this.boundOnCreativeLoaded=this._onCreativeLoaded.bind(this),this.boundOnHistoryPushStateChange=this._onHistoryPushStateChange.bind(this),this.window.addEventListener("__f8-creative-script-loaded",this.boundOnCreativeLoaded),this.window.addEventListener("__f8-product-script-loaded",this.boundOnCreativeLoaded),this.window.addEventListener("__f8-history-push-state",this.boundOnHistoryPushStateChange)},o.prototype._removeEventLisnters=function(){this.window.removeEventListener("__f8-creative-script-loaded",this.boundOnCreativeLoaded),this.window.removeEventListener("__f8-product-script-loaded",this.boundOnCreativeLoaded),this.window.removeEventListener("__f8-history-push-state",this.boundOnHistoryPushStateChange)},o.prototype._onCreativeLoaded=function(e){this.creativeFactoryCache.put(e.creativeRef,e.creativeFactory),this.ads.forEach(function(t){t.evo?t.awaitingFactory&&e.config===t.creativeRef&&(t._setCreativeFactory(e.productFactory),t._callCreativeFactory()):t.awaitingFactory&&e.creativeRef===t.creativeRef&&(t._setCreativeFactory(e.creativeFactory),t._callCreativeFactory())})},o.prototype._onHistoryPushStateChange=function(){this.reloadAllAds().catch()},window.Fresh8||(window.Fresh8=o)});
//# sourceMappingURL=browser.js.map
